# 需求文档

## 简介

班级文件收集系统是一个基于Web的平台，用于管理班级成员信息并收集各类文件（文字、问卷、图片、视频、文档、压缩包等）。系统支持按学院、年级、班级进行分组管理，提供批量导出和自定义重命名功能，方便班级管理员高效收集和整理学生提交的文件。

## 术语表

- **系统**: 班级文件收集系统
- **管理员**: 拥有创建收集任务、管理班级成员、导出文件等权限的用户
- **成员**: 班级中的学生，可以上传文件响应收集任务
- **收集任务**: 管理员创建的文件收集活动，包含截止时间、上传限制等配置
- **学院**: 组织结构的最高层级
- **年级**: 学院下的组织层级
- **班级**: 年级下的最小组织单位，包含多个成员
- **命名格式**: 导出文件时的重命名规则模板
- **提醒**: 通过QQ邮箱向未提交成员发送催交通知

## 需求

### 需求 1

**用户故事:** 作为管理员，我希望能够管理组织结构（学院、年级、班级），以便按层级组织和管理学生信息。

#### 验收标准

1. WHEN 管理员提交学院创建表单 THEN 系统 SHALL 创建新学院并显示在学院列表中
2. WHEN 管理员提交年级创建表单并选择所属学院 THEN 系统 SHALL 在对应学院下创建新年级
3. WHEN 管理员提交班级创建表单并选择所属年级 THEN 系统 SHALL 在对应年级下创建新班级
4. WHEN 管理员修改学院、年级或班级信息 THEN 系统 SHALL 更新对应记录并保持关联关系完整
5. WHEN 管理员删除学院 THEN 系统 SHALL 删除该学院及其下属所有年级和班级
6. WHEN 管理员删除年级 THEN 系统 SHALL 删除该年级及其下属所有班级
7. WHEN 管理员删除班级 THEN 系统 SHALL 删除该班级及其所有成员记录

### 需求 2

**用户故事:** 作为管理员，我希望能够导入和管理班级成员，以便快速建立班级名单。

#### 验收标准

1. WHEN 管理员下载导入模板 THEN 系统 SHALL 提供包含学号、姓名、性别、寝室号、QQ邮箱字段的Excel/CSV模板文件
2. WHEN 管理员上传符合模板格式的文件 THEN 系统 SHALL 解析文件并批量创建成员记录
3. WHEN 导入文件包含重复学号 THEN 系统 SHALL 提示冲突并允许管理员选择跳过或覆盖
4. WHEN 管理员手动添加单个成员 THEN 系统 SHALL 创建包含学号、姓名、性别、寝室号、QQ邮箱的成员记录
5. WHEN 管理员修改成员信息 THEN 系统 SHALL 更新对应成员记录
6. WHEN 管理员删除成员 THEN 系统 SHALL 移除该成员及其所有上传记录
7. WHEN 管理员导出班级成员列表 THEN 系统 SHALL 生成包含所有成员信息的Excel/CSV文件

### 需求 3

**用户故事:** 作为管理员，我希望能够创建和配置收集任务，以便灵活控制文件收集过程。

#### 验收标准

1. WHEN 管理员创建收集任务 THEN 系统 SHALL 允许设置任务名称、描述、支持的文件类型（文字、问卷、图片、视频、文档、压缩包）
2. WHEN 管理员设置收集截止时间 THEN 系统 SHALL 在截止时间后自动禁止新的上传
3. WHEN 管理员设置每人上传次数限制 THEN 系统 SHALL 在达到限制后拒绝该成员的后续上传
4. WHEN 管理员设置是否允许修改 THEN 系统 SHALL 根据设置允许或禁止成员替换已上传文件
5. WHEN 管理员设置仅管理员可见选项 THEN 系统 SHALL 对普通成员隐藏其他人的上传状态
6. WHEN 管理员修改收集任务配置 THEN 系统 SHALL 更新任务设置并立即生效
7. WHEN 管理员删除收集任务 THEN 系统 SHALL 删除任务及其所有关联的上传文件

### 需求 4

**用户故事:** 作为班级成员，我希望能够方便地上传文件响应收集任务，以便完成班级事务。

#### 验收标准

1. WHEN 成员访问收集任务页面 THEN 系统 SHALL 显示班级成员列表，成员点击自己的名字即可进入上传界面
2. WHEN 成员选择文件并提交 THEN 系统 SHALL 上传文件并显示上传进度和完成状态
3. WHEN 成员上传的文件类型不在允许范围内 THEN 系统 SHALL 拒绝上传并提示允许的文件类型
4. WHEN 成员在截止时间后尝试上传 THEN 系统 SHALL 拒绝上传并提示已过截止时间
5. WHEN 成员已达到上传次数限制 THEN 系统 SHALL 拒绝上传并提示已达到上传限制
6. WHEN 任务允许修改且成员已上传文件 THEN 系统 SHALL 允许成员替换已上传的文件
7. WHEN 上传完成 THEN 系统 SHALL 在成员列表中标记该成员已完成上传

### 需求 5

**用户故事:** 作为管理员，我希望能够批量导出收集的文件并自动重命名，以便高效整理和归档。

#### 验收标准

1. WHEN 管理员点击批量导出 THEN 系统 SHALL 将所有已上传文件打包为ZIP文件供下载
2. WHEN 管理员设置命名格式（如"学号_姓名"） THEN 系统 SHALL 保存该格式作为导出时的重命名规则
3. WHEN 导出文件时 THEN 系统 SHALL 根据命名格式将每个文件重命名为对应成员的信息组合
4. WHEN 命名格式包含学号、姓名、性别、寝室号等变量 THEN 系统 SHALL 正确替换为成员的实际信息
5. WHEN 管理员选择部分成员导出 THEN 系统 SHALL 仅导出选中成员的文件
6. WHEN 导出的文件存在同名冲突 THEN 系统 SHALL 自动添加序号后缀以区分

### 需求 6

**用户故事:** 作为管理员，我希望能够查看收集进度和统计信息，以便了解任务完成情况。

#### 验收标准

1. WHEN 管理员查看收集任务 THEN 系统 SHALL 显示已提交人数、未提交人数、总人数的统计
2. WHEN 管理员查看成员列表 THEN 系统 SHALL 用不同颜色或图标标识已提交和未提交的成员
3. WHEN 管理员点击查看未提交名单 THEN 系统 SHALL 显示所有未提交成员的列表
4. WHEN 管理员需要催促未提交成员 THEN 系统 SHALL 提供一键复制未提交成员名单的功能

### 需求 9

**用户故事:** 作为管理员，我希望能够通过QQ邮箱提醒未提交成员，以便提高收集完成率。

#### 验收标准

1. WHEN 管理员创建收集任务 THEN 系统 SHALL 允许设置自动提醒时间（截止前X小时/天）
2. WHEN 到达自动提醒时间且存在未提交成员 THEN 系统 SHALL 自动向未提交成员的QQ邮箱发送提醒邮件
3. WHEN 管理员点击手动提醒按钮 THEN 系统 SHALL 立即向所有未提交成员发送提醒邮件
4. WHEN 管理员选择部分未提交成员并点击提醒 THEN 系统 SHALL 仅向选中成员发送提醒邮件
5. WHEN 发送提醒邮件 THEN 系统 SHALL 在邮件中包含任务名称、截止时间、提交链接等信息
6. WHEN 提醒邮件发送完成 THEN 系统 SHALL 记录发送时间和发送结果
7. WHEN 管理员配置邮箱服务 THEN 系统 SHALL 支持配置SMTP服务器（QQ邮箱SMTP）

### 需求 10

**用户故事:** 作为用户，我希望系统提供安全的身份验证，以便保护数据安全。

#### 验收标准

1. WHEN 管理员首次使用系统 THEN 系统 SHALL 要求设置管理员账号和密码
2. WHEN 用户访问管理功能 THEN 系统 SHALL 验证管理员身份后才允许访问
3. WHEN 成员上传文件 THEN 系统 SHALL 通过班级和姓名验证成员身份
4. WHEN 用户连续多次输入错误密码 THEN 系统 SHALL 临时锁定账号以防止暴力破解

### 需求 11

**用户故事:** 作为开发者，我希望系统采用可部署的架构，以便后期部署到生产环境。

#### 验收标准

1. WHEN 系统启动 THEN 系统 SHALL 使用Python后端框架（Flask/FastAPI）提供RESTful API
2. WHEN 系统部署 THEN 系统 SHALL 支持通过环境变量配置数据库连接、文件存储路径等
3. WHEN 系统运行 THEN 系统 SHALL 将上传文件存储在可配置的目录中
4. WHEN 系统部署 THEN 系统 SHALL 提供Docker容器化部署支持
5. WHEN 开发者查阅文档 THEN 系统 SHALL 提供完整的部署和运行说明文档
